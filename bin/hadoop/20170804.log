nohup: ignoring input
+ prefix_thang=hdfs://nmg01-taihang-hdfs.dmop.baidu.com:54310
+ prefix_khan=hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310
+ prefix_mulan=hdfs://nmg01-mulan-hdfs.dmop.baidu.com:54310
+ hadoop_khan=/home/work/shangbai/lib/hadoop-client-nmg/hadoop/bin/hadoop
+ hadoop_prefix=hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310
+ hadoop_bin=/home/work/shangbai/lib/hadoop-client-nmg/hadoop/bin/hadoop
+ [[ 1 == 1 ]]
+ static_date=20170804
+ path_bad_dict=/home/work/shangbai/data/20170804/bad_dict
+ hadoop_output=hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/liqibo/NA/bad_dict_charge/20170804
+ path_local=/home/work/shangbai/data/20170804/bad_dict_charge
++ list_input 20170804
++ prefix_input=hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/NA/daily_shitu
++ postfix_input='*/part-*'
++ [[ 1 == 1 ]]
++ echo '-input hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/NA/daily_shitu/20170804/*/part-*'
+ hadoop_input='-input hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/NA/daily_shitu/20170804/*/part-*'
+ main_task
+ run_hadoop
+ /home/work/shangbai/lib/hadoop-client-nmg/hadoop/bin/hadoop fs -rmr hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/liqibo/NA/bad_dict_charge/20170804
Moved to trash: hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/liqibo/NA/bad_dict_charge/20170804
+ /home/work/shangbai/lib/hadoop-client-nmg/hadoop/bin/hadoop streaming -input 'hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/NA/daily_shitu/20170804/*/part-*' -output hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/liqibo/NA/bad_dict_charge/20170804 -mapper 'python27/bin/python2.7 mapper.py' -reducer 'python27/bin/python2.7 reducer.py bad_dict' -file mapper.py -file reducer.py -file /home/work/shangbai/data/20170804/bad_dict -cacheArchive /share/python2.7.tar.gz#python27 -jobconf mapred.job.name=liqibo-static -jobconf mapred.job.priority=VERY_HIGH -jobconf mapred.job.queue.name=fcr-adu -jobconf stream.memory.limit=4096 -jobconf mapred.job.map.capacity=3000 -jobconf mapred.map.tasks=2000 -jobconf mapred.job.reduce.capacity=2000 -jobconf mapred.reduce.tasks=1000 -jobconf mapred.job.reduce.memory.mb=5120 -jobconf stream.num.map.output.key.fields=1
17/08/07 17:26:31 WARN streaming.StreamJob: -cacheArchive option is deprecated, please use -archives instead.
17/08/07 17:26:31 WARN streaming.StreamJob: -jobconf option is deprecated, please use -D instead.
packageJobJar: [mapper.py, reducer.py, /home/work/shangbai/data/20170804/bad_dict] [/home/work/shangbai/lib/hadoop-client-nmg/hadoop/contrib/streaming/hadoop-2-streaming.jar] /tmp/streamjob7075448578072280973.jar tmpDir=null
17/08/07 17:26:55 INFO mapred.JobClient: class org.apache.hadoop.security.UnixUserGroupInformation
17/08/07 17:26:55 INFO mapred.JobClient: class org.apache.hadoop.security.UnixUserGroupInformation
17/08/07 17:26:55 INFO hdfs.FMSClient: Write 8725731570571270 in pipeline 10.74.62.43:7001, 10.74.56.15:7001, 10.74.124.15:7001, 10.74.200.22:7001, 10.74.46.35:7001, 10.74.140.25:7001, 10.74.137.24:7001, 10.74.134.17:7001, 10.74.181.43:7001, 10.74.51.46:7001
17/08/07 17:26:58 INFO hdfs.FMSClient: Write 8725731570571513 in pipeline 10.74.54.41:7001, 10.74.142.45:7001, 10.74.180.13:7001, 10.74.129.41:7001, 10.74.211.13:7001, 10.74.160.43:7001, 10.74.132.24:7001, 10.74.219.48:7001, 10.74.130.16:7001, 10.74.217.29:7001
17/08/07 17:26:58 INFO hdfs.FMSClient: Exception in createBlockOutputStream on object /31-27766906912 file /app/dc/deva/system/mapred/job_20170705161142_1601515/job.jar:java.io.IOException: Bad connect ack with firstBadLink 10.74.219.48:7001
17/08/07 17:26:58 INFO hdfs.FMSClient: Excluding node: 10.74.219.48:7001
17/08/07 17:26:58 INFO hdfs.FMSClient: Abandoning block blk_8725731570571513_6562324500
17/08/07 17:27:04 INFO hdfs.FMSClient: Write 8725731570572216 in pipeline 10.74.149.26:7001, 10.74.225.42:7001, 10.74.153.39:7001, 10.74.130.40:7001, 10.74.42.28:7001, 10.74.23.43:7001, 10.74.129.49:7001, 10.74.148.26:7001, 10.74.134.40:7001, 10.74.132.34:7001
17/08/07 17:27:06 INFO hdfs.FMSClient: Write 8725731570572497 in pipeline 10.74.194.28:7001, 10.74.79.53:7001, 10.74.128.50:7001, 10.74.158.50:7001, 10.74.176.34:7001, 10.74.199.20:7001, 10.74.133.46:7001, 10.74.43.16:7001, 10.74.197.12:7001, 10.74.153.15:7001
17/08/07 17:27:09 INFO hdfs.FMSClient: Write 8725731570572769 in pipeline 10.74.212.22:7001, 10.74.178.26:7001, 10.74.35.42:7001, 10.74.134.18:7001, 10.74.134.58:7001, 10.74.163.18:7001, 10.74.20.50:7001, 10.74.146.52:7001, 10.74.136.20:7001, 10.74.30.35:7001
17/08/07 17:27:13 INFO hdfs.FMSClient: Write 8725731570573184 in pipeline 10.74.26.46:7001, 10.74.151.22:7001, 10.74.139.44:7001, 10.74.75.39:7001, 10.74.184.30:7001, 10.74.153.25:7001, 10.74.212.47:7001, 10.74.16.47:7001, 10.74.76.37:7001, 10.74.70.39:7001
17/08/07 17:27:14 INFO util.NativeCodeLoader: Loaded the native-hadoop library
17/08/07 17:27:14 INFO compress.LzoCodec: Successfully loaded & initialized native-lzo library
17/08/07 17:27:14 INFO compress.LzmaCodec: Successfully loaded & initialized native-lzma library
17/08/07 17:27:14 INFO compress.QuickLzCodec: Successfully loaded & initialized native-quicklz library
17/08/07 17:27:14 INFO mapred.FileInputFormat: getInputPaths: dirs: hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/NA/daily_shitu/20170804/*/part-*
17/08/07 17:27:26 INFO mapred.FileInputFormat: Total input paths to process : 1001
17/08/07 17:27:27 WARN mapred.FileInputFormat: Split size is optimized by default, you can set 'abaci.split.optimize.enable=false' to skip it
17/08/07 17:27:29 INFO hdfs.FMSClient: Write 12103431288872933 in pipeline 10.74.165.44:7001, 10.74.58.27:7001, 10.73.80.33:7001
17/08/07 17:27:30 INFO mapred.JobClient: splits size : 2030
17/08/07 17:27:30 INFO hdfs.FMSClient: Write 25895705148902485 in pipeline 10.74.48.37:7001, 10.74.38.41:7001, 10.74.42.47:7001
17/08/07 17:27:30 INFO split.SplitUtils: create hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/dc/deva/system/mapred/job_20170705161142_1601515/split.done
17/08/07 17:27:30 INFO hdfs.FMSClient: Write 16607030917572144 in pipeline 10.74.36.52:7001, 10.74.31.38:7001, 10.74.59.38:7001
17/08/07 17:27:31 INFO mapred.JobClient: Running job: job_20170705161142_1601515
17/08/07 17:27:31 INFO mapred.JobClient: To kill this job, run:
17/08/07 17:27:31 INFO mapred.JobClient: /home/work/shangbai/lib/hadoop-client-nmg/hadoop/bin/../bin/hadoop job -Dmapred.job.tracker=nmg01-khan-abaci.dmop.baidu.com:54311 -kill job_20170705161142_1601515
17/08/07 17:27:31 INFO mapred.JobClient: Tracking URL: http://nmg01-khan-mapred01.nmg01.baidu.com:8030/jobproxy.jsp?jobid=job_20170705161142_1601515
17/08/07 17:28:12 INFO mapred.JobClient: Total split num: 2030
17/08/07 17:28:12 INFO mapred.JobClient: Total split size: 542803 (bytes)
17/08/07 17:28:12 INFO mapred.JobClient: Total split time: 16040 (ms)
17/08/07 17:28:13 INFO mapred.JobClient:  map 0% reduce 0%
17/08/07 17:29:21 INFO mapred.JobClient:  map 1% reduce 0%
17/08/07 17:29:32 INFO mapred.JobClient:  map 3% reduce 0%
17/08/07 17:29:42 INFO mapred.JobClient:  map 7% reduce 0%
17/08/07 17:29:51 INFO mapred.JobClient:  map 15% reduce 0%
17/08/07 17:30:02 INFO mapred.JobClient:  map 28% reduce 0%
17/08/07 17:30:11 INFO mapred.JobClient:  map 43% reduce 0%
17/08/07 17:30:22 INFO mapred.JobClient:  map 59% reduce 0%
17/08/07 17:30:31 INFO mapred.JobClient:  map 81% reduce 0%
17/08/07 17:30:42 INFO mapred.JobClient:  map 89% reduce 0%
17/08/07 17:30:52 INFO mapred.JobClient:  map 90% reduce 0%
17/08/07 17:31:32 INFO mapred.JobClient:  map 99% reduce 0%
17/08/07 17:32:12 INFO mapred.JobClient:  map 100% reduce 0%
17/08/07 17:33:02 INFO mapred.JobClient:  map 100% reduce 2%
17/08/07 17:33:11 INFO mapred.JobClient:  map 100% reduce 4%
17/08/07 17:33:22 INFO mapred.JobClient:  map 100% reduce 9%
17/08/07 17:33:31 INFO mapred.JobClient:  map 100% reduce 14%
17/08/07 17:33:42 INFO mapred.JobClient:  map 100% reduce 18%
17/08/07 17:33:51 INFO mapred.JobClient:  map 100% reduce 24%
17/08/07 17:34:02 INFO mapred.JobClient:  map 100% reduce 31%
17/08/07 17:34:12 INFO mapred.JobClient:  map 100% reduce 37%
17/08/07 17:34:21 INFO mapred.JobClient:  map 100% reduce 50%
17/08/07 17:34:32 INFO mapred.JobClient:  map 100% reduce 64%
17/08/07 17:34:41 INFO mapred.JobClient:  map 100% reduce 78%
17/08/07 17:34:52 INFO mapred.JobClient:  map 100% reduce 88%
17/08/07 17:35:03 INFO mapred.JobClient:  map 100% reduce 92%
17/08/07 17:35:12 INFO mapred.JobClient:  map 100% reduce 96%
17/08/07 17:35:22 INFO mapred.JobClient:  map 100% reduce 97%
17/08/07 17:35:32 INFO mapred.JobClient:  map 100% reduce 98%
17/08/07 17:35:52 INFO mapred.JobClient:  map 100% reduce 99%
17/08/07 17:38:44 INFO mapred.JobClient: Updating completed job! Ignoring ...
17/08/07 17:38:44 INFO mapred.JobClient: Updating completed job! Ignoring ...
17/08/07 17:38:44 INFO mapred.JobClient: Job complete: job_20170705161142_1601515
17/08/07 17:38:44 INFO streaming.StreamJob: Output: hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/liqibo/NA/bad_dict_charge/20170804
+ [[ -f /home/work/shangbai/data/20170804/bad_dict_charge ]]
+ /home/work/shangbai/lib/hadoop-client-nmg/hadoop/bin/hadoop fs -getmerge hdfs://nmg01-khan-hdfs.dmop.baidu.com:54310/app/ecom/fcr/liqibo/NA/bad_dict_charge/20170804 /home/work/shangbai/data/20170804/bad_dict_charge
